# Repository Guidelines

## Project Structure & Module Organization
- `src/` — TypeScript source. Key modules: `index.ts` (server bootstrap), `proxy.ts` (\`/v1/*\` proxy + SSE), `routes/` (`ui.ts`, `oauth.ts`, `accounts.ts`), `refresh.ts`, `selection.ts`, `storage.ts`, `converters.ts`, `utils.ts`, `config.ts`, `types.ts`.
- `dist/` — compiled JS output (generated by TypeScript).
- `auths/` — local token storage (`codex_tokens.json`, `rr-index`). Git-ignored; treat as secrets.
- Root configs: `package.json`, `tsconfig.json`, `.gitignore`, `README.md`.

## Build, Test, and Development Commands
- `npm install` — install dependencies.
- `npm run dev` — compile TypeScript then start the server at `http://localhost:1456`.
- `npm run build` — compile to `dist/` (ES2020, ESM).
- `npm start` — run compiled server from `dist/`.
- `npm test` — placeholder (no test suite yet).

## Coding Style & Naming Conventions
- Language: TypeScript (ESM, `type: module`, strict). Target Node 18+.
- Indentation: 2 spaces; include semicolons; prefer named exports; avoid default exports.
- Filenames: lowercase, concise (e.g., `proxy.ts`, `selection.ts`); route handlers live under `src/routes/`.
- Types: avoid `any`; prefer explicit `types.ts` definitions; keep side effects in `index.ts` only.

## Testing Guidelines
- No framework configured. If adding tests, prefer Vitest or Jest.
- Location: `src/__tests__/` or co-located next to modules.
- Naming: `*.test.ts`. Aim to cover `converters`, `selection`, and `refresh` logic.
- Run via `npm test` after wiring a test runner.

## Commit & Pull Request Guidelines
- Use Conventional Commits (e.g., `feat: ...`, `fix: ...`, `refactor: ...`). Example seen: `refactor: streamline index.ts ...`.
- PRs should include: clear summary, linked issues, manual test notes (URLs/curls), and screenshots for UI changes (`/` view).
- Ensure `npm run build` passes and no secrets from `auths/` are committed.

## Security & Configuration Tips
- Tokens in `auths/` are sensitive; never log or commit them (`.gitignore` covers this).
- Default port is `1456` (see `config.ts`). Update docs if changing.
- Upstream proxy targets ChatGPT Codex; do not alter headers or endpoints without rationale.

## Agent-Specific Notes
- Keep changes minimal and consistent with existing style; do not introduce new deps without discussion.
- Preserve API surface (`/v1/*`, `/accounts`, `/oauth/*`). If extending, update `README.md` and UI accordingly.
